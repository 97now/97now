SBOOK, SFLIGHT 도움말 검토

<img width="1099" height="645" alt="Image" src="https://github.com/user-attachments/assets/736ae36a-ee40-4ae7-8491-37f6d474745f" />

Srch Help를 더블 클릭하면 어떻게 구성되어 있는지 확인 가능
---

데이터 베이스 뷰

⇒ 여러 테이블을 하나로 합쳐서 볼 수 있는 뷰

<img width="1359" height="413" alt="Image" src="https://github.com/user-attachments/assets/ce3063fd-2eef-4d0d-80f2-81a7dd823d0a" />

<img width="824" height="641" alt="Image" src="https://github.com/user-attachments/assets/8503890b-19ee-4e16-b389-b81796813a4f" />

연결되어 있는 것들을 확인 할 수 있음
---

Collective srch hlp ⇒ 도움말이 탭으로 나뉘어져 있고  두개 이상 넣는거.

elementry srch hlp ⇒ 도움말 하나 넣은거

<img width="1109" height="613" alt="Image" src="https://github.com/user-attachments/assets/4ac6dd68-4898-41d7-893e-79b1892b710c" />

도움말 창이 두개 이상임(여행사와 일반 고객 도움말 두개로 구성)

<img width="822" height="188" alt="Image" src="https://github.com/user-attachments/assets/4140130b-8dc1-4e79-8633-54e251d6e52c" />

<img width="657" height="226" alt="Image" src="https://github.com/user-attachments/assets/a873a364-307a-4196-a83a-dd9f6fd7e513" />

어떤식으로 구성되어 있는지도 확인 가능
---
### SELECT-OPTIONS
```
TABLES spfli. " SELECT-OPTIONS를 사용할때는 내가 사용할 테이블을 선언해줘야한다. 안그러면 실행 불가능

SELECTION-SCREEN BEGIN OF BLOCK part1 WITH FRAME TITLE text-001.
SELECT-OPTIONS s_carrid FOR spfli-carrid.
SELECTION-SCREEN END OF BLOCK part1.
```

Parameters는 TABLES 선언을 안해도 쓸 수 있는데 SELECT-OPTIONS는 테이블을 선언해주어야한다.

SELECT OPTIONS : 옵션들을 선택한다. ⇒ 하나만, 범위, 옵션없이 전체 조회(단일값을 조회할게 아니면 거의 셀렉트 옵션 사용)

<img width="1478" height="511" alt="Image" src="https://github.com/user-attachments/assets/fc1c59f0-0f88-4076-a1b6-835a8c12a659" />

행/ 테이블이 같은 이름으로  with headerline 구조로 되어있음.

<img width="1036" height="249" alt="Image" src="https://github.com/user-attachments/assets/6203232f-5c3f-49d4-b0aa-0a4a14ae0ba6" />

조회할때 AA 입력하면 이런 형식으로 나옴

I : include / EQ : equal

<img width="1042" height="249" alt="Image" src="https://github.com/user-attachments/assets/91b9b1e5-141d-4efb-b847-c21a1eb20b48" />

AA, AC 로 조회하면 이런 형식으로 나옴

I : include / BT : between ⇒ AA부터 AC까지 조회
---

SELECT OPTIONS 두칸을 만들어주고 옵션들을 넣을 수 있게 해준다.

with headerline 구조로 테이블/행 같이 선언

<img width="653" height="238" alt="Image" src="https://github.com/user-attachments/assets/bc22fad1-7eb9-4c84-bced-3a6b9945d7c7" />

START-OF-SELECTION이 시작부분이니 그 위에 SELECTION-OPTIONS을 넣는다.

<img width="478" height="141" alt="Image" src="https://github.com/user-attachments/assets/8c122f50-e113-476b-959f-d40f5360e054" />

WHERE carrid IN s_carrid.를 넣어준다.

조회할때 범위 지정 가능. 아무것도 입력하지 않고 조회 시 전부 다 나온다.

<img width="643" height="84" alt="Image" src="https://github.com/user-attachments/assets/6b4f0121-5f5f-4b45-8bf7-0e3fc61a61fc" />

<img width="611" height="147" alt="Image" src="https://github.com/user-attachments/assets/3bd9bd87-8410-4dcc-ba79-e0fa717bc28e" />

PARAMETERS는 하나씩만 조회 가능. 조회할때 아무것도 입력하지 않으면 조회가 되지 않는다.

- OBLIGATORY 를 SELCTION 부분에 추가해주면 값을 넣어야한다는걸 알 수 있기 때문에 넣어주는게 좋다. / 디폴트 값도 넣어주면 Best


<img width="605" height="73" alt="Image" src="https://github.com/user-attachments/assets/feb6870f-a01b-42b4-ada5-f1f5cc7cc983" />

<img width="783" height="165" alt="Image" src="https://github.com/user-attachments/assets/1ddc156f-2052-4cc5-b29b-34519a17628e" />

- SELECTION-OPTIONS는 8글자를 초과할 수 없다.

<img width="636" height="237" alt="Image" src="https://github.com/user-attachments/assets/d9a3a7eb-dd91-4c8c-9219-a1886e9ce8bc" />

<img width="703" height="126" alt="Image" src="https://github.com/user-attachments/assets/c095e04e-4a24-4304-8d1f-21f4f6fa1439" />

<img width="836" height="497" alt="Image" src="https://github.com/user-attachments/assets/7983dd87-58a1-49fe-ba60-5b0b5de1df44" />

Select Single Values : 보고 싶은 값 하나 / ex) AA

Select Ranges : 보고 싶은 값의 범위 / ex) AB ~ AZ

Exclude Single Values : 보고 싶지 않은 값 하나 / ex) AB

Exclude Ranges : 보고 싶지 않은 값의 범위 / ex) AC ~ AF

<img width="493" height="269" alt="Image" src="https://github.com/user-attachments/assets/b9696bcb-2b74-492c-99be-2ee2d017ca1c" />


EQ 같다 / BT 사이
---

INITIZLIZATION : 검색화면이 나오기전에 싱행되는 부분.

(초기화, 검색화면에 초기값을 설정하는 용도로 많이 쓴다.)

START-OF-SELECTION. ⇒ 이벤트

검색화면에서 실행버튼 누르니까 탄다. 선택을 시작한다.
---

<img width="482" height="512" alt="Image" src="https://github.com/user-attachments/assets/67f02b31-330d-416b-b79a-93fd454294e5" />

값을 미리 넣기
---
```
AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_cname-low. " 이벤트
* s_cname-low = 'American Airlines'.

  TYPES : BEGIN OF abc,
    carrname type scarr-carrname,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc.

  SELECT CARRNAME FROM SCARR
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING
      RETFIELD         = 'CARRNAME'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_cname-low'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES
      VALUE_TAB        = IT_F4HELP3
      RETURN_TAB       = IT_RETURN_TAB
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_cname-high.
*  s_cname-high = 'American Airlines'.


  TYPES : BEGIN OF abc,
    carrname type scarr-carrname,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc. " 도움말이 되는 부분

  SELECT CARRNAME FROM SCARR
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING
      RETFIELD         = 'CARRNAME'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_cname-high'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES
      VALUE_TAB        = IT_F4HELP3
      RETURN_TAB       = IT_RETURN_TAB
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.

*&---------------------------------------------------------------------*
*&      Form  call_back2
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->RECORD_TAB   text
*      -->SHLP_TOP     text
*      -->CALLCONTROL  text
*----------------------------------------------------------------------*
FORM CALL_BACK2 TABLES RECORD_TAB STRUCTURE SEAHLPRES
               CHANGING SHLP_TOP TYPE SHLP_DESCR
                     CALLCONTROL LIKE DDSHF4CTRL.

  SHLP_TOP-INTDESCR-DIALOGTYPE = 'A'.   "A 100개 이상이면 다이알로그 조회, D 즉시조회,  C 다이알로그 조회

ENDFORM.                    "call_back

```

CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST’

TABLES

 VALUE_TAB        = IT_F4HELP3 이걸 넣으면 도움말 나옴

---

오늘 과제는
scarr alv에서
url 로 도움말을 만들어봐라

spfli 프로그램 ALV

carrid
connid
fltime
deptime
arrtime

carrid connid 별로 검색
셀렉트옵션으로 검색하는거
---
### 과제 1

<img width="1089" height="712" alt="Image" src="https://github.com/user-attachments/assets/4ffff287-67f4-4173-83c3-9842e2c55822" />

```
*&---------------------------------------------------------------------*
*& Report Z6WEEK_ALV02
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT Z6WEEK_ALV02.

TABLES: SCARR.

TYPE-POOLS: slis.                                 "ALV Declarations

*Data Declaration
*----------------
TYPES: BEGIN OF t_scarr,
  mandt TYPE scarr-mandt,
  carrid TYPE scarr-carrid,
  carrname TYPE scarr-carrname,
  currcode TYPE scarr-currcode,
  url TYPE scarr-url,
 END OF t_scarr.

DATA: it_scarr TYPE STANDARD TABLE OF t_scarr INITIAL SIZE 0,
      wa_scarr TYPE t_scarr.

*ALV data declarations
DATA: fieldcatalog TYPE slis_t_fieldcat_alv WITH HEADER LINE,
      gd_tab_group TYPE slis_t_sp_group_alv,
      gd_layout    TYPE slis_layout_alv,
      gd_repid     LIKE sy-repid.


DATA : t TYPE slis_t_sp_group_alv .

SELECTION-SCREEN BEGIN OF BLOCK part1 WITH FRAME TITLE text-001.
SELECT-OPTIONS s_carrid   FOR scarr-carrid.

SELECTION-SCREEN SKIP. "한칸 띄우기

SELECT-OPTIONS s_cname FOR scarr-carrname.
SELECT-OPTIONS s_ccode FOR scarr-currcode.
SELECT-OPTIONS s_url   FOR scarr-url.

SELECTION-SCREEN SKIP. "한칸 띄우기

PARAMETERS NUM TYPE I.
" PARAMETERS p_carrid TYPE scarr-carrid OBLIGATORY DEFAULT 'AA'.
" PARAMETERS는 비워져 있다면 조회시 아무것도 안나오니까 필수값을 표시하는 OBLIGATORY는 넣어주는게 좋다.
" 기본적으로 값이 입력되게끔 DEFAULT 'value' 도 같이 넣어두면 좋다.
SELECTION-SCREEN END OF BLOCK part1.

*INITIALIZATION. " 값을 미리 넣기위해 이걸 입력해야된다.
*
*  s_carrid-sign   = 'I'.
*  s_carrid-option   = 'EQ'.
*  s_carrid-low     = 'AA'.
*  "s_carrid-high   = ''.
*  APPEND s_carrid TO s_carrid.
*  CLEAR  s_carrid.
*
*  s_carrid-sign   = 'I'.
*  s_carrid-option   = 'BT'.
*  s_carrid-low     = 'AA'.
*  s_carrid-high   = 'AZ'.
*  APPEND s_carrid TO s_carrid.
*  CLEAR  s_carrid.
*
*  s_carrid-sign   = 'E'.
*  s_carrid-option   = 'EQ'.
*  s_carrid-low     = 'AB'.
*  "s_carrid-high   = ''.
*  APPEND s_carrid TO s_carrid.
*  CLEAR  s_carrid.
*
*  s_carrid-sign   = 'E'.
*  s_carrid-option   = 'BT'.
*  s_carrid-low     = 'AC'.
*  s_carrid-high   = 'AF'.
*  APPEND s_carrid TO s_carrid.
*  CLEAR  s_carrid.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_cname-low. " 이벤트
* s_cname-low = 'American Airlines'.

  TYPES : BEGIN OF abc,
    carrname type scarr-carrname,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc. " 도움말이 되는 부분

  SELECT CARRNAME FROM SCARR
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING " 오른쪽에 있는걸 왼쪽에 넣어서 가져다 쓴다. 펑션에서는 import 탭
      RETFIELD         = 'CARRNAME'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_cname-low'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES " exporting 일 수도 improting 일 수도 있다.
      VALUE_TAB        = IT_F4HELP3 " 방금 select 했으니 exporting일 것이다.
      RETURN_TAB       = IT_RETURN_TAB " 방금 선언했고 아무것도 안넣음. importing 일거다.
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.

  NUM = 10.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_cname-high.
*  s_cname-high = 'American Airlines'.

  TYPES : BEGIN OF abc,
    carrname type scarr-carrname,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc.

  SELECT CARRNAME FROM SCARR
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING
      RETFIELD         = 'CARRNAME'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_cname-high'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES
      VALUE_TAB        = IT_F4HELP3
      RETURN_TAB       = IT_RETURN_TAB
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_url-low. " 이벤트
* s_cname-low = 'American Airlines'.

  TYPES : BEGIN OF abc,
    carrname type scarr-url,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc. " 도움말이 되는 부분

  SELECT URL FROM SCARR
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING " 오른쪽에 있는걸 왼쪽에 넣어서 가져다 쓴다. 펑션에서는 import 탭
      RETFIELD         = 'CARRNAME'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_url-low'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES " exporting 일 수도 improting 일 수도 있다.
      VALUE_TAB        = IT_F4HELP3 " 방금 select 했으니 exporting일 것이다.
      RETURN_TAB       = IT_RETURN_TAB " 방금 선언했고 아무것도 안넣음. importing 일거다.
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.

  NUM = 10.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_url-high.
*  s_cname-high = 'American Airlines'.

  TYPES : BEGIN OF abc,
    carrname type scarr-url,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc.

  SELECT URL FROM SCARR
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING
      RETFIELD         = 'CARRNAME'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_url-high'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES
      VALUE_TAB        = IT_F4HELP3
      RETURN_TAB       = IT_RETURN_TAB
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.
*&---------------------------------------------------------------------*
*&      Form  call_back2
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->RECORD_TAB   text
*      -->SHLP_TOP     text
*      -->CALLCONTROL  text
*----------------------------------------------------------------------*
FORM CALL_BACK2 TABLES RECORD_TAB STRUCTURE SEAHLPRES
               CHANGING SHLP_TOP TYPE SHLP_DESCR
                     CALLCONTROL LIKE DDSHF4CTRL.

  SHLP_TOP-INTDESCR-DIALOGTYPE = 'A'.   "A 100개 이상이면 다이알로그 조회, D 즉시조회,  C 다이알로그 조회

ENDFORM.                    "call_back


************************************************************************
*Start-of-selection.
START-OF-SELECTION.

  PERFORM data_retrieval.
  PERFORM build_fieldcatalog.
  PERFORM build_layout.
  PERFORM display_alv_report.


*&---------------------------------------------------------------------*
*&      Form  BUILD_FIELDCATALOG
*&---------------------------------------------------------------------*
*       Build Fieldcatalog for ALV Report
*----------------------------------------------------------------------*
FORM build_fieldcatalog.

  fieldcatalog-fieldname   = 'MANDT'.
  fieldcatalog-seltext_m   = 'Client'.
  fieldcatalog-col_pos     = 0.
  fieldcatalog-outputlen   = 10.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'CARRID'.
  fieldcatalog-seltext_m   = 'Airline Code'.
  fieldcatalog-col_pos     = 1.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'CARRNAME'.
  fieldcatalog-seltext_m   = 'Airline name'.
  fieldcatalog-col_pos     = 2.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'CURRCODE'.
  fieldcatalog-seltext_m   = 'Local currency of airline'.
  fieldcatalog-col_pos     = 3.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'URL'.
  fieldcatalog-seltext_m   = 'Airline URL'.
  fieldcatalog-col_pos     = 4.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

ENDFORM.                    " BUILD_FIELDCATALOG


*&---------------------------------------------------------------------*
*&      Form  BUILD_LAYOUT
*&---------------------------------------------------------------------*
*       Build layout for ALV grid report
*----------------------------------------------------------------------*
FORM build_layout.

  gd_layout-no_input          = 'X'.
  gd_layout-colwidth_optimize = 'X'.
  gd_layout-zebra = 'X'.
*  gd_layout-info_fieldname =      'LINE_COLOR'.
*  gd_layout-def_status = 'A'.

ENDFORM.                    " BUILD_LAYOUT


*&---------------------------------------------------------------------*
*&      Form  DISPLAY_ALV_REPORT
*&---------------------------------------------------------------------*
*       Display report using ALV grid
*----------------------------------------------------------------------*
FORM display_alv_report.
  gd_repid = sy-repid.
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      i_callback_program = gd_repid
      is_layout          = gd_layout
      it_fieldcat        = fieldcatalog[]
      i_save             = 'X'
    TABLES
      t_outtab           = it_scarr
    EXCEPTIONS
      program_error      = 1
      OTHERS             = 2.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.





ENDFORM.                    " DISPLAY_ALV_REPORT


*&---------------------------------------------------------------------*
*&      Form  DATA_RETRIEVAL
*&---------------------------------------------------------------------*
*       Retrieve data form EKPO table and populate itab it_ekko
*----------------------------------------------------------------------*
FORM data_retrieval.
  DATA: ld_color(1) TYPE c.

  SELECT mandt carrid carrname currcode url
   UP TO NUM ROWS " NUM에 입력된 갯수만큼 출력
    FROM scarr
    INTO TABLE it_scarr
    WHERE carrid   IN s_carrid
      AND carrname IN s_cname
      AND currcode IN s_ccode
      AND url      IN s_url.
    "WHERE carrid = p_carrid. " 단일 값이라 등호를 붙여서 조건을 준다.

ENDFORM.                    " DATA_RETRIEVAL
```
---
### 과제 2

<img width="941" height="581" alt="Image" src="https://github.com/user-attachments/assets/cb499d3b-3ed6-4a7b-8b2c-49ab206e5502" />

<img width="702" height="207" alt="Image" src="https://github.com/user-attachments/assets/35d42a04-8afe-4058-a4cf-6fa0c470a143" />

<img width="787" height="540" alt="Image" src="https://github.com/user-attachments/assets/c8d3e950-dc7a-4c35-a0a2-1ebac1f93c67" />

<img width="674" height="155" alt="Image" src="https://github.com/user-attachments/assets/911271ba-edd6-4ade-b0eb-6982e71eb0d9" />
```
*&---------------------------------------------------------------------*
*& Report Z6WEEK_ALV03
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT Z6WEEK_ALV03.

TABLES: SPFLI.

TYPE-POOLS: slis.                                 "ALV Declarations

*Data Declaration
*----------------
TYPES: BEGIN OF t_spfli,
  carrid TYPE spfli-carrid,
  connid TYPE spfli-connid,
  fltime TYPE spfli-fltime,
  deptime TYPE spfli-deptime,
  arrtime TYPE spfli-arrtime,
 END OF t_spfli.

DATA: it_spfli TYPE STANDARD TABLE OF t_spfli INITIAL SIZE 0,
      wa_spfli TYPE t_spfli.

*ALV data declarations
DATA: fieldcatalog TYPE slis_t_fieldcat_alv WITH HEADER LINE,
      gd_tab_group TYPE slis_t_sp_group_alv,
      gd_layout    TYPE slis_layout_alv,
      gd_repid     LIKE sy-repid.


DATA : t TYPE slis_t_sp_group_alv .

SELECTION-SCREEN BEGIN OF BLOCK part1 WITH FRAME TITLE text-001.

SELECT-OPTIONS s_carrid FOR spfli-carrid.
SELECT-OPTIONS s_connid FOR spfli-connid.

SELECTION-SCREEN SKIP. "한칸 띄우기

SELECT-OPTIONS s_fltime   FOR spfli-fltime.
SELECT-OPTIONS s_dtime  FOR spfli-deptime.
SELECT-OPTIONS s_artime  FOR spfli-arrtime.

PARAMETERS NUM TYPE I.
" PARAMETERS p_carrid TYPE scarr-carrid OBLIGATORY DEFAULT 'AA'.
SELECTION-SCREEN END OF BLOCK part1.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_carrid-low. " 이벤트

  TYPES : BEGIN OF abc,
    carrid type spfli-carrid,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc. " 도움말이 되는 부분

  SELECT CARRID FROM SPFLI
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING " 오른쪽에 있는걸 왼쪽에 넣어서 가져다 쓴다. 펑션에서는 import 탭
      RETFIELD         = 'CARRID'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_carrid-low'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES " exporting 일 수도 improting 일 수도 있다.
      VALUE_TAB        = IT_F4HELP3 " 방금 select 했으니 exporting일 것이다.
      RETURN_TAB       = IT_RETURN_TAB " 방금 선언했고 아무것도 안넣음. importing 일거다.
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.

  NUM = 10.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR s_connid-low. " 이벤트

  TYPES : BEGIN OF abc,
    connid type spfli-connid,
  END of abc.

  DATA: IT_F4HELP3 TYPE TABLE OF abc. " 도움말이 되는 부분

  SELECT CONNID FROM SPFLI
  INTO TABLE IT_F4HELP3.

    DATA: IT_RETURN_TAB TYPE ddshretval OCCURS 0 WITH HEADER LINE .

    CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING " 오른쪽에 있는걸 왼쪽에 넣어서 가져다 쓴다. 펑션에서는 import 탭
      RETFIELD         = 'CONNID'
      VALUE_ORG        = 'S'
      DYNPROFIELD      = 's_connid-low'
      DYNPPROG         = SY-REPID
      DYNPNR           = SY-DYNNR
      CALLBACK_FORM    = 'CALL_BACK2'
      CALLBACK_PROGRAM = SY-REPID
    TABLES " exporting 일 수도 improting 일 수도 있다.
      VALUE_TAB        = IT_F4HELP3 " 방금 select 했으니 exporting일 것이다.
      RETURN_TAB       = IT_RETURN_TAB " 방금 선언했고 아무것도 안넣음. importing 일거다.
    EXCEPTIONS
      PARAMETER_ERROR  = 1
      NO_VALUES_FOUND  = 2
      OTHERS           = 3.

  NUM = 10.

*&---------------------------------------------------------------------*
*&      Form  call_back2
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->RECORD_TAB   text
*      -->SHLP_TOP     text
*      -->CALLCONTROL  text
*----------------------------------------------------------------------*
FORM CALL_BACK2 TABLES RECORD_TAB STRUCTURE SEAHLPRES
               CHANGING SHLP_TOP TYPE SHLP_DESCR
                     CALLCONTROL LIKE DDSHF4CTRL.

  SHLP_TOP-INTDESCR-DIALOGTYPE = 'A'.   "A 100개 이상이면 다이알로그 조회, D 즉시조회,  C 다이알로그 조회

ENDFORM.                    "call_back


************************************************************************
*Start-of-selection.
START-OF-SELECTION.

  PERFORM data_retrieval.
  PERFORM build_fieldcatalog.
  PERFORM build_layout.
  PERFORM display_alv_report.


*&---------------------------------------------------------------------*
*&      Form  BUILD_FIELDCATALOG
*&---------------------------------------------------------------------*
*       Build Fieldcatalog for ALV Report
*----------------------------------------------------------------------*
FORM build_fieldcatalog.

  fieldcatalog-fieldname   = 'CARRID'.
  fieldcatalog-seltext_m   = 'Airline'.
  fieldcatalog-col_pos     = 0.
  fieldcatalog-outputlen   = 10.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'CONNID'.
  fieldcatalog-seltext_m   = 'Connection'.
  fieldcatalog-col_pos     = 1.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'FLTIME'.
  fieldcatalog-seltext_m   = 'Flight Time'.
  fieldcatalog-col_pos     = 2.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'DEPTIME'.
  fieldcatalog-seltext_m   = 'Departure'.
  fieldcatalog-col_pos     = 3.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

  fieldcatalog-fieldname   = 'ARRTIME'.
  fieldcatalog-seltext_m   = 'Arrival'.
  fieldcatalog-col_pos     = 4.
  APPEND fieldcatalog TO fieldcatalog.
  CLEAR  fieldcatalog.

ENDFORM.                    " BUILD_FIELDCATALOG


*&---------------------------------------------------------------------*
*&      Form  BUILD_LAYOUT
*&---------------------------------------------------------------------*
*       Build layout for ALV grid report
*----------------------------------------------------------------------*
FORM build_layout.

  gd_layout-no_input          = 'X'.
  gd_layout-colwidth_optimize = 'X'.
  gd_layout-zebra = 'X'.
*  gd_layout-info_fieldname =      'LINE_COLOR'.
*  gd_layout-def_status = 'A'.

ENDFORM.                    " BUILD_LAYOUT


*&---------------------------------------------------------------------*
*&      Form  DISPLAY_ALV_REPORT
*&---------------------------------------------------------------------*
*       Display report using ALV grid
*----------------------------------------------------------------------*
FORM display_alv_report.
  gd_repid = sy-repid.
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      i_callback_program = gd_repid
      is_layout          = gd_layout
      it_fieldcat        = fieldcatalog[]
      i_save             = 'X'
    TABLES
      t_outtab           = it_spfli
    EXCEPTIONS
      program_error      = 1
      OTHERS             = 2.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.





ENDFORM.                    " DISPLAY_ALV_REPORT


*&---------------------------------------------------------------------*
*&      Form  DATA_RETRIEVAL
*&---------------------------------------------------------------------*
*       Retrieve data form EKPO table and populate itab it_ekko
*----------------------------------------------------------------------*
FORM data_retrieval.
  DATA: ld_color(1) TYPE c.

  SELECT carrid connid fltime deptime arrtime
   UP TO NUM ROWS " NUM에 입력된 갯수만큼 출력
    FROM spfli
    INTO TABLE it_spfli
    WHERE carrid   IN s_carrid
      AND connid IN s_connid
      AND fltime IN s_fltime
      AND deptime      IN s_dtime
      AND arrtime IN s_artime.
    "WHERE carrid = p_carrid. " 단일 값이라 등호를 붙여서 조건을 준다.

ENDFORM.                    " DATA_RETRIEVAL
```